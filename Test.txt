function exportUsersToCSV(groupName, users) {
    const rows = [];

    // Nutzer aufteilen
    const activeUsers = users.filter(user => user.active);
    const inactiveUsers = users.filter(user => !user.active);

    // Aktive Nutzer-Header mit Count
    rows.push(`Aktive Nutzer (${activeUsers.length})`);
    rows.push(['UserName', 'DisplayName', 'Email'].join(';'));
    activeUsers.forEach(function(user) {
        const userName = user.name || '';
        const displayName = user.displayName || '';
        const email = user.emailAddress || '';
        rows.push([userName, displayName, email].join(';'));
    });

    // Leerzeile
    rows.push('');

    // Inaktive Nutzer-Header mit Count
    rows.push(`Inaktive Nutzer (${inactiveUsers.length})`);
    rows.push(['UserName', 'DisplayName', 'Email'].join(';'));
    inactiveUsers.forEach(function(user) {
        const userName = user.name || '';
        const displayName = user.displayName || '';
        const email = user.emailAddress || '';
        rows.push([userName, displayName, email].join(';'));
    });

    // CSV generieren und herunterladen
    const csvContent = "\uFEFF" + rows.join('\n');
    const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
    const blobUrl = URL.createObjectURL(blob);

    const link = document.createElement('a');
    link.href = blobUrl;
    link.download = `${groupName}.csv`;
    document.body.appendChild(link);
    link.click();
    document.body.removeChild(link);
}
