function exportGroupAsCSV(groupName) {
    const maxResults = 100;
    let startAt = 0;
    let allUsers = [];

    function fetchPage(callback) {
        $.ajax({
            url: '/rest/api/2/group/member',
            type: 'GET',
            dataType: 'json',
            data: {
                groupname: groupName,
                includeInactiveUsers: 'false',
                startAt: startAt,
                maxResults: maxResults
            },
            success: function(data) {
                allUsers = allUsers.concat(data.values);
                if (data.values.length === maxResults) {
                    startAt += maxResults;
                    fetchPage(callback); // NÃ¤chste Seite
                } else {
                    callback(allUsers); // Alle Seiten fertig
                }
            },
            error: function(err) {
                console.error('Fehler beim Laden der Gruppenmitglieder:', err);
            }
        });
    }

    fetchPage(function(users) {
        // CSV exportieren
        const rows = [];
        rows.push(['UserName', 'DisplayName', 'Email'].join(';'));

        users.forEach(function(user) {
            const userName = user.name || '';
            const displayName = user.displayName || '';
            const email = user.emailAddress || '';
            rows.push([userName, displayName, email].join(';'));
        });

        const csvContent = "\uFEFF" + rows.join('\n');
        const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
        const blobUrl = URL.createObjectURL(blob);

        const link = document.createElement('a');
        link.href = blobUrl;
        link.download = `${groupName}.csv`;
        document.body.appendChild(link);
        link.click();
        document.body.removeChild(link);
    });
}
