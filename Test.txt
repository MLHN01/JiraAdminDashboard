Date getLastDeactivationDate(String username) {
    def auditSearchService = ComponentAccessor.getOSGiComponentInstanceOfType(AuditSearchService)

    def offset = 0
    def limit = 1000 // Anzahl der Audit-Log-Einträge zum Durchsuchen (anpassen, wenn nötig)

    def records = auditSearchService.getRecords(offset, limit)
        .findAll { AuditRecord record ->
            record.action == "User deactivated" && 
            record.affectedObjects.any { AuditResource resource ->
                resource.name == username
            }
        }
        .sort { a, b -> b.created <=> a.created }

    if (records) {
        return Date.from(records.first().created.atZone(ZoneId.systemDefault()).toInstant())
    }

    return null
}
