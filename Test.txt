import com.atlassian.audit.api.AuditEntityCursor
import com.atlassian.jira.component.ComponentAccessor
import com.atlassian.audit.api.AuditSearchService
import com.atlassian.audit.api.AuditQuery
import com.atlassian.audit.api.util.pagination.PageRequest

AuditSearchService auditSearchService = ComponentAccessor.getOSGiComponentInstanceOfType(AuditSearchService)
AuditQuery auditQuery = AuditQuery.builder().searchText("User deactivated").build()

// from https://developer.atlassian.com/server/framework/atlassian-sdk/audit/
final PageRequest<AuditEntityCursor> pageRequest = new PageRequest.Builder<AuditEntityCursor>()
                .offset(0)
                .limit(100)
                .build();

// Intended usage:
def results = auditSearchService.findBy(auditQuery, pageRequest)
