Date getLastDeactivationDate(String username) {
    def auditSearchService = ComponentAccessor.getOSGiComponentInstanceOfType(AuditSearchService)

    // AuditQuery erstellen, um nach "User deactivated" Aktionen zu suchen
    def query = AuditQuery.builder()
        .actions("User deactivated")
        .build()

    // Paginierte Suche, um die neuesten 10 Einträge zu erhalten
    def pageRequest = PageRequest.ofSize(10)

    // Audit-Einträge abrufen
    def page = auditSearchService.findBy(query, pageRequest)

    // Filtere nach dem betroffenen Nutzer
    def records = page.getResults().findAll { AuditEntity entity ->
        entity.getAffectedObjects().any { it.getName() == username }
    }.sort { -it.getCreated().toEpochMilli() } // Sortiere absteigend nach Zeitstempel

    if (records) {
        return Date.from(records.first().getCreated().atZone(ZoneId.systemDefault()).toInstant())
    }

    return null
}
